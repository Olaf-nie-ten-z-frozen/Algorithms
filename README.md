Children on the Island really enjoyed puzzling Ada and Serweryn's staff, inquiring about ways to spend their free time at their sites. Recently, for example, they were introduced to the culture of soccer fans (the team included a Motor Lublin fan) and the fact that a Mexican wave is made in the grandstand during games. The wave seemed so interesting to them that the children tried to recreate it as they stood in a circle. The first person would raise their hands up, followed by the next person, and so on. But due to the lack of football excitement and the relatively small number of participants, after a few laps of the wave they got bored with it. They decided to change the rules a bit and create a game based on the Mexican wave.

The children got into pairs and stood in a circle. Then the person from the pair standing on the left swapped places with the person on the left from the neighboring pair (between the pair is the right person from the pair on the left and the left person from the pair on the right). Later, one of the players would start a wave by raising his hands in the air, the neighboring person would repeat this, and so on. If one of the participants made a mistake (raised his hands too early, too late, not in his turn or forgot) - he was out of the game (there could still be another person from the pair in the game). The game then continues starting with the person who was the last to make the correct move, but with the direction changed.

The player who had just raised his hands could initiate a return wave, that is, change the direction of the game by giving a command and raising his hands again. The winner was the pair that stayed in the game the longest. The pair also won when only one person remained in the game.

This improved version of the Mexican wave appealed so much to the children that those who dropped out early wanted to get back into the game as soon as possible. Participants agreed that the game itself was more important than winning, so sometimes, after a mistake by one player, pairs who had dropped out earlier were allowed to return to the circle. The returning pair would stand in such a way that there would be two people between them, next to whom was the player who had just dropped out.

For example: Initial positioning of 3 people next to each other: P1 P2 P3 After the mistake of person P2: P1 P3 After the new pair joined: Pn P1 P3 Pn

Ada and Serweryn's group, observing the children's actions, decided to simulate their gameplay.

Input: The input gives the natural numbers n, p, k, denoting the number of pairs, the number of the pair starting the game (pairs are numbered from 0, the game is started by the person on the right) and the initial turn of the game, where 0 - clockwise, 1 - counterclockwise. We assume that at the start the pairs stand numbered ascending just clockwise. In the next line there is a natural number m, determining the number of operations, in the next m lines there will be descriptors of op operations, the parameter x and, in a special case, a flag (that is, the line can contain two or three natural numbers). Operations are defined as follows:

0 x - make x moves in the game (one move is the raising of hands by one person) and display the current state of the game starting with the person in the pair on which the round stopped after x moves according to the current turn of movement. 1 x flag - mistake by a person and possible return of the eliminated pair; departure of the person on whom the round stops after x moves; for the flag: 1 - the pair that has been out of the game for the longest time returns to the game, 0 - nothing happens as long as there are more than 3 people left in the circle after the departure of the player, otherwise the pair that has been out of the game for the longest time returns to the game. 2 x - change of direction of movement; after x moves, the xth person in order makes an additional move to signify a change of direction and subsequent raises are counted in the opposite direction (the additional raise of the hands is counted as the first move after the change of direction). 3 ≤ n ≤ 10000 k = {0, 1} 1 ≤ m ≤ 10000 op = {0, 1, 2}

Output: On the output, the program prints the effects of the operation to display the current state of the game. Example: Input: 5 4 1 6 2 6 2 3 1 7 0 0 2 1 3 0 0 5 Output: 4 1 0 2 1 3 2 4 0 2 3 1 2 1 4 0 4 Note: The task is intended to be a stand-alone implementation of lists without the use of STL libraries.